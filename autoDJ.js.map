{"version":3,"sources":["webpack:///autoDJ.js","webpack:///./src/constants/actionNames.js","webpack:///./src/components/Row.jsx","webpack:///./src/flux.js","webpack:///./src/components/Column.jsx","webpack:///./src/components/FluidContainer.jsx","webpack:///./src/components/Gliff.jsx","webpack:///./src/components/Track.jsx","webpack:///./src/components/mixins.js","webpack:///./src/constants/storeNames.js","webpack:///./src/actions/actions.js","webpack:///./src/actions/nextTrack.js","webpack:///./src/actions/pauseMusic.js","webpack:///./src/actions/playMusic.js","webpack:///./src/actions/trackPlaying.js","webpack:///./src/actions/uploadTrack.js","webpack:///./src/components/Button.jsx","webpack:///./src/components/Layout.jsx","webpack:///./src/components/Player.jsx","webpack:///./src/components/Playlist.jsx","webpack:///./src/components/Tracks.jsx","webpack:///./src/components/nav-bar-container.jsx","webpack:///./src/history.js","webpack:///./src/main.jsx","webpack:///./src/stores/Playlist.js","webpack:///./src/stores/beatDetector.js"],"names":["webpackJsonp",0,"module","exports","__webpack_require__",51,"UPLOAD_TRACK","NEXT_TRACK","PLAY","PAUSE","TRACK_PLAYING",73,"React","Row","createClass","displayName","render","createElement","className","this","props","children",74,"Fluxxor","actions","PlaylistStore","stores","playlist","flux","Flux",100,"Column","propTypes","s","PropTypes","number","isRequired","m","l","generateClassName",140,"FluidContainer",141,"Gliff","gliff","string","aria-hidden",142,"Col","Track","propertTypes","object","track","name","bpm","renderTrackAnalysis","analysed","renderAnalysis","renderAwaitingAnalysis","peaks","reduce","grabEveryFourthPeak","map","createSomeRectangles","acc","val","index","push","peak","bufferLength","x","key","y","width","height",143,"LinkedStateMixin","storeWatch","StoreWatchMixin",144,"PLAY_LIST",333,"uploadTrack","nextTrack","play","pause","trackPlaying",334,"actionNames","dispatch",335,336,337,"source","gain","trackLoaded",338,339,"SaveButton","click","func","type","onClick",340,"NavBarContainer","Layout",341,"Button","mixins","storeNames","fadeTimeSeconds","startTrackAt","context","AudioContext","Player","getDefaultProps","getStateFromFlux","store","getState","audioLoaded","state","resume","enqueueTrack","tracks","currentTrack","that","Promise","resolve","then","console","log","prepTrack","_ref","fadeIn","_ref2","savePlayingTrack","suspend","debug","decodeAudioData","arrayBuffer","buffer","createBufferSource","gainNode","createGain","connect","destination","currentTime","exponentialRampToValueAtTime","start","setTimeout","fadeOut","stop","skip","nextSource","undefined","nextGain","_ref3","renderTrack","renderPlayOrPause","playing",342,"Dropzone","Tracks","Playlist","onDrop","files","multiple",343,"id",344,"Link","data-toggle","data-target","aria-expanded","aria-controls","to",345,"history","createHistory",346,"reactRouter","Router","Route","IndexRoute","ReactDom","path","component","components","document","getElementById",347,"uuid","R","beatDetector","createStore","initialize","bindActions","dealWithUploadedTrack","drop","emit","uploadedTrack","_this","v1","reader","FileReader","reject","onload","event","onerror","readAsArrayBuffer","fileReadEvent","OfflineContext","window","OfflineAudioContext","webkitOfflineAudioContext","offlineContext","target","result","filter","createBiquadFilter","initialThresold","thresold","minThresold","minPeaks","getPeaksAtThreshold","getChannelData","length","intervals","countIntervalsBetweenNearbyPeaks","groups","groupNeighborsByTempo","sampleRate","top","sort","intA","intB","count","splice","tempo","error",348,"data","threshold","peaksArray","i","intervalCounts","forEach","interval","foundInterval","some","intervalCount","tempoCounts","theoreticalTempo","Math","round","foundTempo","tempoCount",469],"mappings":"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","file":"autoDJ.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(346);\n\tmodule.exports = __webpack_require__(469);\n\n\n/***/ },\n\n/***/ 51:\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = {\n\t  UPLOAD_TRACK: 'track.upload',\n\t  NEXT_TRACK: 'tack.next',\n\t  PLAY: 'track.play',\n\t  PAUSE: 'track.pause',\n\t  TRACK_PLAYING: 'track.playing'\n\t};\n\n/***/ },\n\n/***/ 73:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar Row = React.createClass({\n\t  displayName: \"Row\",\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      \"div\",\n\t      { className: \"row\" },\n\t      this.props.children\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = Row;\n\n/***/ },\n\n/***/ 74:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar Fluxxor = __webpack_require__(86);\n\t\n\tvar actions = __webpack_require__(333);\n\t\n\tvar PlaylistStore = __webpack_require__(347);\n\t\n\tvar stores = {\n\t  playlist: new PlaylistStore()\n\t};\n\t\n\tvar flux = new Fluxxor.Flux(stores, actions);\n\t\n\tmodule.exports = flux;\n\n/***/ },\n\n/***/ 100:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar Column = React.createClass({\n\t  displayName: 'Column',\n\t\n\t  propTypes: {\n\t    s: React.PropTypes.number.isRequired,\n\t    m: React.PropTypes.number,\n\t    l: React.PropTypes.number\n\t  },\n\t\n\t  generateClassName: function generateClassName() {\n\t    var className = 'col-xs-' + this.props.s;\n\t    if (this.props.m) {\n\t      className = className + ' col-md-' + this.props.m;\n\t    }\n\t    if (this.props.l) {\n\t      className = className + ' col-lg-' + this.props.l;\n\t    }\n\t    return className;\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'div',\n\t      { className: this.generateClassName() },\n\t      this.props.children\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = Column;\n\n/***/ },\n\n/***/ 140:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar FluidContainer = React.createClass({\n\t  displayName: \"FluidContainer\",\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      \"div\",\n\t      { className: \"container-fluid\" },\n\t      this.props.children\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = FluidContainer;\n\n/***/ },\n\n/***/ 141:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar Gliff = React.createClass({\n\t  displayName: \"Gliff\",\n\t\n\t  propTypes: {\n\t    gliff: React.PropTypes.string.isRequired\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(\"span\", { className: \"glyphicon glyphicon-\" + this.props.gliff, \"aria-hidden\": \"true\" });\n\t  }\n\t});\n\t\n\tmodule.exports = Gliff;\n\n/***/ },\n\n/***/ 142:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar Row = __webpack_require__(73),\n\t    Col = __webpack_require__(100);\n\t\n\tvar Track = React.createClass({\n\t  displayName: 'Track',\n\t\n\t  propertTypes: {\n\t    Track: React.PropTypes.object.isRequired\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'div',\n\t      { className: 'track' },\n\t      React.createElement(\n\t        Row,\n\t        null,\n\t        React.createElement(\n\t          Col,\n\t          { s: 6 },\n\t          this.props.track.name\n\t        ),\n\t        React.createElement(\n\t          Col,\n\t          { s: 6 },\n\t          this.props.track.bpm\n\t        )\n\t      ),\n\t      React.createElement(\n\t        Row,\n\t        null,\n\t        React.createElement(\n\t          Col,\n\t          { s: 12 },\n\t          this.renderTrackAnalysis()\n\t        )\n\t      )\n\t    );\n\t  },\n\t\n\t  renderTrackAnalysis: function renderTrackAnalysis() {\n\t    if (this.props.track.analysed) {\n\t      return this.renderAnalysis();\n\t    }\n\t\n\t    return this.renderAwaitingAnalysis();\n\t  },\n\t\n\t  renderAnalysis: function renderAnalysis() {\n\t    return React.createElement(\n\t      'svg',\n\t      { className: 'track-analysis' },\n\t      this.props.track.peaks.reduce(this.grabEveryFourthPeak, []).map(this.createSomeRectangles)\n\t    );\n\t  },\n\t\n\t  renderAwaitingAnalysis: function renderAwaitingAnalysis() {\n\t    return React.createElement(\n\t      'div',\n\t      { className: 'awaiting-analysis' },\n\t      React.createElement(\n\t        'span',\n\t        null,\n\t        'Awaiting Analysis'\n\t      )\n\t    );\n\t  },\n\t\n\t  grabEveryFourthPeak: function grabEveryFourthPeak(acc, val, index) {\n\t    if (index % 4 === 0) {\n\t      acc.push(val);\n\t    }\n\t    return acc;\n\t  },\n\t\n\t  createSomeRectangles: function createSomeRectangles(peak) {\n\t    var bufferLength = this.props.track.bufferLength;\n\t\n\t    var x = 100 * peak / bufferLength + '%';\n\t\n\t    return React.createElement('rect', { key: x, x: x, y: '0', width: '1', height: '100%' });\n\t  }\n\t});\n\t\n\tmodule.exports = Track;\n\n/***/ },\n\n/***/ 143:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar Fluxxor = __webpack_require__(86);\n\tvar LinkedStateMixin = __webpack_require__(297);\n\t\n\tmodule.exports = {\n\t  storeWatch: Fluxxor.StoreWatchMixin,\n\t  LinkedStateMixin: LinkedStateMixin\n\t};\n\n/***/ },\n\n/***/ 144:\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = {\n\t  PLAY_LIST: 'playlist'\n\t};\n\n/***/ },\n\n/***/ 333:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tmodule.exports = {\n\t  uploadTrack: __webpack_require__(338),\n\t  nextTrack: __webpack_require__(334),\n\t  play: __webpack_require__(336),\n\t  pause: __webpack_require__(335),\n\t  trackPlaying: __webpack_require__(337)\n\t};\n\n/***/ },\n\n/***/ 334:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar actionNames = __webpack_require__(51);\n\t\n\tvar uploadTrack = function uploadTrack() {\n\t  this.dispatch(actionNames.NEXT_TRACK);\n\t};\n\t\n\tmodule.exports = uploadTrack;\n\n/***/ },\n\n/***/ 335:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar actionNames = __webpack_require__(51);\n\t\n\tvar uploadTrack = function uploadTrack() {\n\t  this.dispatch(actionNames.PAUSE);\n\t};\n\t\n\tmodule.exports = uploadTrack;\n\n/***/ },\n\n/***/ 336:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar actionNames = __webpack_require__(51);\n\t\n\tvar uploadTrack = function uploadTrack() {\n\t  this.dispatch(actionNames.PLAY);\n\t};\n\t\n\tmodule.exports = uploadTrack;\n\n/***/ },\n\n/***/ 337:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar actionNames = __webpack_require__(51);\n\t\n\tvar uploadTrack = function uploadTrack(source, gain, trackLoaded) {\n\t  this.dispatch(actionNames.TRACK_PLAYING, { source: source, gain: gain, trackLoaded: trackLoaded });\n\t};\n\t\n\tmodule.exports = uploadTrack;\n\n/***/ },\n\n/***/ 338:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar actionNames = __webpack_require__(51);\n\t\n\tvar uploadTrack = function uploadTrack(track) {\n\t  this.dispatch(actionNames.UPLOAD_TRACK, track);\n\t};\n\t\n\tmodule.exports = uploadTrack;\n\n/***/ },\n\n/***/ 339:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar Gliff = __webpack_require__(141);\n\t\n\tvar SaveButton = React.createClass({\n\t  displayName: 'SaveButton',\n\t\n\t  propTypes: {\n\t    click: React.PropTypes.func.isRequired,\n\t    gliff: React.PropTypes.string.isRequired\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'button',\n\t      { type: 'button', onClick: this.props.click, className: 'btn btn-primary btn-block' },\n\t      React.createElement(Gliff, { gliff: this.props.gliff })\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = SaveButton;\n\n/***/ },\n\n/***/ 340:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5),\n\t    NavBarContainer = __webpack_require__(344);\n\t\n\tvar Layout = React.createClass({\n\t  displayName: 'Layout',\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'div',\n\t      null,\n\t      React.createElement(NavBarContainer, null),\n\t      this.props.children\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = Layout;\n\n/***/ },\n\n/***/ 341:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar Col = __webpack_require__(100),\n\t    Row = __webpack_require__(73),\n\t    FluidContainer = __webpack_require__(140),\n\t    Track = __webpack_require__(142),\n\t    Button = __webpack_require__(339);\n\t\n\tvar flux = __webpack_require__(74),\n\t    mixins = __webpack_require__(143),\n\t    storeNames = __webpack_require__(144);\n\t\n\tvar fadeTimeSeconds = 3; // seconds\n\tvar startTrackAt = 70; // seconds\n\t\n\tvar context = new AudioContext();\n\t\n\tvar Player = React.createClass({\n\t  displayName: 'Player',\n\t\n\t  mixins: [mixins.storeWatch(storeNames.PLAY_LIST)],\n\t\n\t  getDefaultProps: function getDefaultProps() {\n\t    return {\n\t      flux: flux\n\t    };\n\t  },\n\t\n\t  getStateFromFlux: function getStateFromFlux() {\n\t    return flux.store(storeNames.PLAY_LIST).getState();\n\t  },\n\t\n\t  play: function play() {\n\t    var audioLoaded = this.state.trackLoaded;\n\t\n\t    if (audioLoaded) {\n\t      this.resume();\n\t    } else {\n\t      this.enqueueTrack();\n\t    }\n\t  },\n\t\n\t  enqueueTrack: function enqueueTrack() {\n\t    var tracks = flux.store(storeNames.PLAY_LIST).getState().tracks,\n\t        currentTrack = tracks[0],\n\t        that = this;\n\t\n\t    Promise.resolve().then(function () {\n\t      console.log('starting playing');\n\t      return flux.actions.play();\n\t    }).then(function () {\n\t      return that.prepTrack(currentTrack);\n\t    }).then(function (_ref) {\n\t      var source = _ref.source;\n\t      var gain = _ref.gain;\n\t\n\t      return that.fadeIn(source, gain);\n\t    }).then(function (_ref2) {\n\t      var source = _ref2.source;\n\t      var gain = _ref2.gain;\n\t\n\t      return that.savePlayingTrack(source, gain);\n\t    });\n\t  },\n\t\n\t  pause: function pause() {\n\t    context.suspend();\n\t    flux.actions.pause();\n\t  },\n\t\n\t  resume: function resume() {\n\t    context.resume();\n\t    flux.actions.play();\n\t  },\n\t\n\t  savePlayingTrack: function savePlayingTrack(source, gain) {\n\t    return new Promise(function (resolve) {\n\t      console.debug('save playing track');\n\t      flux.actions.trackPlaying(source, gain, true);\n\t      console.debug('now playing');\n\t      resolve();\n\t    });\n\t  },\n\t\n\t  prepTrack: function prepTrack(track) {\n\t    console.debug('preparing track', track);\n\t    return new Promise(function (resolve) {\n\t      context.decodeAudioData(track.arrayBuffer, function (buffer) {\n\t        var source = context.createBufferSource();\n\t        var gainNode = context.createGain();\n\t        source.buffer = buffer;\n\t        source.connect(gainNode);\n\t        gainNode.connect(context.destination);\n\t        console.log('track prepared', track);\n\t        resolve({ source: source, gain: gainNode });\n\t      });\n\t    });\n\t  },\n\t\n\t  fadeIn: function fadeIn(source, gainNode) {\n\t    return new Promise(function (resolve) {\n\t      console.debug('fading in');\n\t      var currentTime = context.currentTime;\n\t\n\t      gainNode.gain.exponentialRampToValueAtTime(0.1, currentTime);\n\t      gainNode.gain.exponentialRampToValueAtTime(1.0, currentTime + fadeTimeSeconds);\n\t\n\t      source.start(0, startTrackAt);\n\t\n\t      setTimeout(function () {\n\t        console.debug('faded track in');\n\t        resolve({ source: source, gain: gainNode });\n\t      }, fadeTimeSeconds * 1000);\n\t    });\n\t  },\n\t\n\t  fadeOut: function fadeOut(source, gainNode) {\n\t\n\t    var currentTime = context.currentTime;\n\t\n\t    console.debug('fading out');\n\t\n\t    return new Promise(function (resolve) {\n\t      gainNode.gain.exponentialRampToValueAtTime(1.0, currentTime);\n\t      gainNode.gain.exponentialRampToValueAtTime(0.1, currentTime + fadeTimeSeconds);\n\t\n\t      setTimeout(function () {\n\t        console.debug('faded out');\n\t        source.stop();\n\t        resolve();\n\t      }, fadeTimeSeconds * 1000);\n\t    });\n\t  },\n\t\n\t  skip: function skip() {\n\t    var that = this,\n\t        state = flux.store(storeNames.PLAY_LIST).getState(),\n\t        tracks = state.tracks,\n\t        nextTrack = tracks[1];\n\t\n\t    var nextSource = undefined,\n\t        nextGain = undefined;\n\t\n\t    Promise.resolve().then(function () {\n\t      return that.prepTrack(nextTrack);\n\t    }).then(function (_ref3) {\n\t      var source = _ref3.source;\n\t      var gain = _ref3.gain;\n\t\n\t      nextSource = source;\n\t      nextGain = gain;\n\t      return that.fadeIn(source, gain);\n\t    }).then(function () {\n\t      return that.fadeOut(state.source, state.gain);\n\t    }).then(function () {\n\t      return that.savePlayingTrack(nextSource, nextGain);\n\t    }).then(function () {\n\t      console.log('next Track');\n\t      flux.actions.nextTrack();\n\t    });\n\t\n\t    //  move playlist on\n\t  },\n\t\n\t  render: function render() {\n\t\n\t    var tracks = flux.store(storeNames.PLAY_LIST).getState().tracks,\n\t        currentTrack = tracks[0],\n\t        nextTrack = tracks[1];\n\t\n\t    return React.createElement(\n\t      FluidContainer,\n\t      null,\n\t      React.createElement(\n\t        Row,\n\t        null,\n\t        this.renderTrack(currentTrack)\n\t      ),\n\t      React.createElement(\n\t        Row,\n\t        null,\n\t        this.renderTrack(nextTrack)\n\t      ),\n\t      React.createElement('hr', null),\n\t      React.createElement(\n\t        Row,\n\t        null,\n\t        React.createElement(\n\t          Col,\n\t          { s: 6 },\n\t          this.renderPlayOrPause()\n\t        ),\n\t        React.createElement(\n\t          Col,\n\t          { s: 6 },\n\t          React.createElement(Button, { gliff: 'forward', click: this.skip })\n\t        )\n\t      )\n\t    );\n\t  },\n\t\n\t  renderTrack: function renderTrack(currentTrack) {\n\t    if (currentTrack) {\n\t      return React.createElement(Track, { track: currentTrack });\n\t    }\n\t    return React.createElement(\n\t      'div',\n\t      null,\n\t      React.createElement(\n\t        'p',\n\t        null,\n\t        'Queue Some Tracks!'\n\t      )\n\t    );\n\t  },\n\t\n\t  renderPlayOrPause: function renderPlayOrPause() {\n\t    if (this.state.playing) {\n\t      return React.createElement(Button, { gliff: 'pause', click: this.pause });\n\t    }\n\t    return React.createElement(Button, { gliff: 'play', click: this.play });\n\t  }\n\t});\n\t\n\tmodule.exports = Player;\n\n/***/ },\n\n/***/ 342:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar flux = __webpack_require__(74);\n\t\n\tvar Dropzone = __webpack_require__(298),\n\t    FluidContainer = __webpack_require__(140),\n\t    Row = __webpack_require__(73),\n\t    Tracks = __webpack_require__(343);\n\t\n\tvar Playlist = React.createClass({\n\t  displayName: 'Playlist',\n\t\n\t  onDrop: function onDrop(files) {\n\t    console.log(files);\n\t    flux.actions.uploadTrack(files[0]);\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'div',\n\t      { className: 'playlist' },\n\t      React.createElement(\n\t        FluidContainer,\n\t        null,\n\t        React.createElement(\n\t          Row,\n\t          null,\n\t          React.createElement(\n\t            Dropzone,\n\t            { className: 'upload', onDrop: this.onDrop, multiple: false },\n\t            React.createElement(\n\t              'span',\n\t              { className: 'upload-txt' },\n\t              'Drop Tracks here, or click to select tracks from your file system'\n\t            )\n\t          )\n\t        ),\n\t        React.createElement(\n\t          Row,\n\t          null,\n\t          React.createElement(Tracks, null)\n\t        )\n\t      )\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = Playlist;\n\n/***/ },\n\n/***/ 343:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5);\n\t\n\tvar flux = __webpack_require__(74),\n\t    mixins = __webpack_require__(143),\n\t    storeNames = __webpack_require__(144);\n\t\n\tvar Row = __webpack_require__(73),\n\t    Col = __webpack_require__(100),\n\t    Track = __webpack_require__(142);\n\t\n\tvar Tracks = React.createClass({\n\t  displayName: 'Tracks',\n\t\n\t  mixins: [mixins.storeWatch(storeNames.PLAY_LIST)],\n\t\n\t  getDefaultProps: function getDefaultProps() {\n\t    return {\n\t      flux: flux\n\t    };\n\t  },\n\t\n\t  getStateFromFlux: function getStateFromFlux() {\n\t    return flux.store(storeNames.PLAY_LIST).getState();\n\t  },\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'div',\n\t      { className: 'tracks' },\n\t      React.createElement(\n\t        Row,\n\t        null,\n\t        React.createElement(\n\t          Col,\n\t          { s: 12 },\n\t          React.createElement(\n\t            'ol',\n\t            null,\n\t            this.state.tracks.map(this.renderTrack)\n\t          )\n\t        )\n\t      )\n\t    );\n\t  },\n\t\n\t  renderTrack: function renderTrack(track) {\n\t    return React.createElement(\n\t      'li',\n\t      { key: track.id },\n\t      React.createElement(Track, { track: track })\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = Tracks;\n\n/***/ },\n\n/***/ 344:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar React = __webpack_require__(5),\n\t    Link = __webpack_require__(119).Link,\n\t    Gliff = __webpack_require__(141);\n\t\n\tvar NavBarContainer = React.createClass({\n\t  displayName: 'NavBarContainer',\n\t\n\t  render: function render() {\n\t    return React.createElement(\n\t      'nav',\n\t      { className: 'navbar navbar-default navbar-fixed-top' },\n\t      React.createElement(\n\t        'div',\n\t        { className: 'container-fluid' },\n\t        React.createElement(\n\t          'div',\n\t          { className: 'navbar-header' },\n\t          React.createElement(\n\t            'button',\n\t            { type: 'button', className: 'navbar-toggle collapsed',\n\t              'data-toggle': 'collapse', 'data-target': '#navbar', 'aria-expanded': 'false', 'aria-controls': 'navbar' },\n\t            React.createElement(\n\t              'span',\n\t              { className: 'sr-only' },\n\t              'Toggle navigation'\n\t            ),\n\t            React.createElement('span', { className: 'icon-bar' }),\n\t            React.createElement('span', { className: 'icon-bar' }),\n\t            React.createElement('span', { className: 'icon-bar' })\n\t          ),\n\t          React.createElement(\n\t            Link,\n\t            { to: '/' },\n\t            React.createElement(\n\t              'h3',\n\t              null,\n\t              React.createElement(Gliff, { gliff: 'cd' }),\n\t              ' Auto DJ'\n\t            )\n\t          )\n\t        ),\n\t        React.createElement(\n\t          'div',\n\t          { id: 'navbar', className: 'navbar-collapse collapse' },\n\t          React.createElement(\n\t            'ul',\n\t            { className: 'nav navbar-nav' },\n\t            React.createElement(\n\t              'li',\n\t              null,\n\t              React.createElement(\n\t                Link,\n\t                { to: '/playlist' },\n\t                React.createElement(Gliff, { gliff: 'list' }),\n\t                '  Play List'\n\t              )\n\t            ),\n\t            React.createElement(\n\t              'li',\n\t              null,\n\t              React.createElement(\n\t                Link,\n\t                { to: '/player' },\n\t                React.createElement(Gliff, { gliff: 'equalizer' }),\n\t                '  Playing'\n\t              )\n\t            )\n\t          )\n\t        )\n\t      )\n\t    );\n\t  }\n\t});\n\t\n\tmodule.exports = NavBarContainer;\n\n/***/ },\n\n/***/ 345:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar history = __webpack_require__(184).createHistory();\n\t\n\tmodule.exports = history;\n\n/***/ },\n\n/***/ 346:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t// FLUX CONFIG\n\t\n\t__webpack_require__(74);\n\t\n\t// ROUTE CONFIG\n\t\n\tvar React = __webpack_require__(5),\n\t    // eslint-disable-line no-unused-vars\n\treactRouter = __webpack_require__(119),\n\t    Router = reactRouter.Router,\n\t    Route = reactRouter.Route,\n\t    IndexRoute = reactRouter.IndexRoute,\n\t    ReactDom = __webpack_require__(117);\n\t\n\tvar Layout = __webpack_require__(340),\n\t    Player = __webpack_require__(341),\n\t    Playlist = __webpack_require__(342);\n\t\n\tvar history = __webpack_require__(345);\n\t\n\tReactDom.render(React.createElement(\n\t  Router,\n\t  { history: history },\n\t  React.createElement(\n\t    Route,\n\t    { path: './', component: Layout },\n\t    React.createElement(Route, { path: 'player', component: Player }),\n\t    React.createElement(IndexRoute, { component: Playlist }),\n\t    React.createElement(Route, { path: 'playlist', components: Playlist })\n\t  )\n\t), document.getElementById('app'));\n\n/***/ },\n\n/***/ 347:\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar Fluxxor = __webpack_require__(86),\n\t    uuid = __webpack_require__(331),\n\t    R = __webpack_require__(296);\n\t\n\tvar actionNames = __webpack_require__(51),\n\t    beatDetector = __webpack_require__(348);\n\t\n\tvar PlaylistStore = Fluxxor.createStore({\n\t\n\t  initialize: function initialize() {\n\t    this.state = {\n\t      tracks: [],\n\t      playing: false,\n\t      trackLoaded: false\n\t    };\n\t\n\t    this.bindActions(actionNames.UPLOAD_TRACK, this.dealWithUploadedTrack, actionNames.NEXT_TRACK, this.nextTrack, actionNames.PLAY, this.play, actionNames.PAUSE, this.pause, actionNames.TRACK_PLAYING, this.trackPlaying);\n\t  },\n\t\n\t  getState: function getState() {\n\t    return this.state;\n\t  },\n\t\n\t  nextTrack: function nextTrack() {\n\t    this.state.tracks = R.drop(1, this.state.tracks);\n\t    this.emit('change');\n\t  },\n\t\n\t  play: function play() {\n\t    this.state.playing = true;\n\t    this.state.trackLoaded = true;\n\t    this.emit('change');\n\t  },\n\t\n\t  pause: function pause() {\n\t    this.state.playing = false;\n\t    this.emit('change');\n\t  },\n\t\n\t  trackPlaying: function trackPlaying(_ref) {\n\t    var source = _ref.source;\n\t    var gain = _ref.gain;\n\t    var trackLoaded = _ref.trackLoaded;\n\t\n\t    this.state.source = source;\n\t    this.state.gain = gain;\n\t    this.state.trackLoaded = trackLoaded;\n\t    this.emit('change');\n\t  },\n\t\n\t  dealWithUploadedTrack: function dealWithUploadedTrack(uploadedTrack) {\n\t    var _this = this;\n\t\n\t    var track = {\n\t      id: uuid.v1(),\n\t      name: uploadedTrack.name,\n\t      type: uploadedTrack.type,\n\t      analysed: false,\n\t      track: uploadedTrack\n\t    };\n\t\n\t    var that = this;\n\t\n\t    var reader = new FileReader();\n\t\n\t    Promise.resolve().then(function () {\n\t      return new Promise(function (resolve) {\n\t        console.log('adding track');\n\t        _this.state.tracks.push(track);\n\t        _this.emit('change');\n\t        resolve();\n\t      });\n\t    }).then(function () {\n\t      return new Promise(function (resolve, reject) {\n\t        console.log('reading uploaded file');\n\t        reader.onload = function (event) {\n\t          console.log('loaded file');\n\t          resolve(event);\n\t        };\n\t\n\t        reader.onerror = function (event) {\n\t          console.log('failed to load file');\n\t          reject(event);\n\t        };\n\t\n\t        reader.readAsArrayBuffer(uploadedTrack);\n\t      });\n\t    }).then(function (fileReadEvent) {\n\t      return new Promise(function (resolve) {\n\t        console.log('crunching bpm', fileReadEvent);\n\t        var OfflineContext = window.OfflineAudioContext || window.webkitOfflineAudioContext;\n\t        var offlineContext = new OfflineContext(1, 2, 44100);\n\t\n\t        track.arrayBuffer = fileReadEvent.target.result;\n\t\n\t        offlineContext.decodeAudioData(fileReadEvent.target.result, function (buffer) {\n\t\n\t          // Create buffer source\n\t          var source = offlineContext.createBufferSource();\n\t          source.buffer = buffer;\n\t\n\t          // Create filter\n\t          var filter = offlineContext.createBiquadFilter();\n\t          filter.type = 'lowpass';\n\t\n\t          // Pipe the song into the filter, and the filter into the offline context\n\t          source.connect(filter);\n\t          filter.connect(offlineContext.destination);\n\t\n\t          // Schedule the song to start playing at time:0\n\t          source.start(0);\n\t\n\t          var peaks,\n\t              initialThresold = 0.9,\n\t              thresold = initialThresold,\n\t              minThresold = 0.3,\n\t              minPeaks = 30;\n\t\n\t          do {\n\t            peaks = beatDetector.getPeaksAtThreshold(buffer.getChannelData(0), thresold);\n\t            thresold -= 0.05;\n\t          } while (peaks.length < minPeaks && thresold >= minThresold);\n\t\n\t          var intervals = beatDetector.countIntervalsBetweenNearbyPeaks(peaks);\n\t\n\t          var groups = beatDetector.groupNeighborsByTempo(intervals, buffer.sampleRate);\n\t\n\t          var top = groups.sort(function (intA, intB) {\n\t            return intB.count - intA.count;\n\t          }).splice(0, 5);\n\t\n\t          track.peaks = peaks;\n\t          track.analysed = true;\n\t          track.bpm = top[0].tempo;\n\t          track.bufferLength = buffer.length;\n\t          resolve();\n\t        });\n\t      });\n\t    }).catch(function (error) {\n\t      return console.error('failed to bpm match the file', error);\n\t    }).then(function () {\n\t      console.log('done analysis');\n\t      that.emit('change');\n\t    });\n\t  }\n\t});\n\t\n\tmodule.exports = PlaylistStore;\n\n/***/ },\n\n/***/ 348:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\t// lifted from https://github.com/JMPerez/beats-audio-api/blob/gh-pages/script.js - thank you JMPerez :)\n\t\n\tvar getPeaksAtThreshold = function getPeaksAtThreshold(data, threshold) {\n\t  var peaksArray = [];\n\t  var length = data.length;\n\t  for (var i = 0; i < length;) {\n\t    if (data[i] > threshold) {\n\t      peaksArray.push(i);\n\t      // Skip forward ~ 1/4s to get past this peak.\n\t      i += 10000;\n\t    }\n\t    i++;\n\t  }\n\t  return peaksArray;\n\t};\n\t\n\t// Function used to return a histogram of peak intervals\n\tvar countIntervalsBetweenNearbyPeaks = function countIntervalsBetweenNearbyPeaks(peaks) {\n\t  var intervalCounts = [];\n\t  peaks.forEach(function (peak, index) {\n\t    for (var i = 0; i < 10; i++) {\n\t      var interval = peaks[index + i] - peak;\n\t      var foundInterval = intervalCounts.some(function (intervalCount) {\n\t        // eslint-disable-line no-loop-func\n\t        if (intervalCount.interval === interval) {\n\t          return intervalCount.count++;\n\t        }\n\t      });\n\t      if (!foundInterval) {\n\t        intervalCounts.push({\n\t          interval: interval,\n\t          count: 1\n\t        });\n\t      }\n\t    }\n\t  });\n\t  return intervalCounts;\n\t};\n\t\n\t// Function used to return a histogram of tempo candidates.\n\tvar groupNeighborsByTempo = function groupNeighborsByTempo(intervalCounts, sampleRate) {\n\t  var tempoCounts = [];\n\t  intervalCounts.forEach(function (intervalCount) {\n\t    if (intervalCount.interval !== 0) {\n\t      // Convert an interval to tempo\n\t      var theoreticalTempo = 60 / (intervalCount.interval / sampleRate);\n\t\n\t      // Adjust the tempo to fit within the 90-180 BPM range\n\t      while (theoreticalTempo < 90) {\n\t        theoreticalTempo *= 2;\n\t      }\n\t      while (theoreticalTempo > 180) {\n\t        theoreticalTempo /= 2;\n\t      }\n\t\n\t      theoreticalTempo = Math.round(theoreticalTempo);\n\t      var foundTempo = tempoCounts.some(function (tempoCount) {\n\t        if (tempoCount.tempo === theoreticalTempo) {\n\t          tempoCount.count += intervalCount.count;\n\t          return tempoCount.count;\n\t        }\n\t      });\n\t      if (!foundTempo) {\n\t        tempoCounts.push({\n\t          tempo: theoreticalTempo,\n\t          count: intervalCount.count\n\t        });\n\t      }\n\t    }\n\t  });\n\t  return tempoCounts;\n\t};\n\t\n\tmodule.exports = {\n\t  getPeaksAtThreshold: getPeaksAtThreshold,\n\t  countIntervalsBetweenNearbyPeaks: countIntervalsBetweenNearbyPeaks,\n\t  groupNeighborsByTempo: groupNeighborsByTempo\n\t};\n\n/***/ },\n\n/***/ 469:\n/***/ function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }\n\n});\n\n\n/** WEBPACK FOOTER **\n ** autoDJ.js\n **/","module.exports = {\n  UPLOAD_TRACK: 'track.upload',\n  NEXT_TRACK: 'tack.next',\n  PLAY: 'track.play',\n  PAUSE: 'track.pause',\n  TRACK_PLAYING: 'track.playing'\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/constants/actionNames.js\n **/","const React = require('react');\n\nconst Row = React.createClass({\n  render: function () {\n    return (\n      <div className=\"row\">\n        {\n          this.props.children\n        }\n      </div>\n    );\n  }\n});\n\nmodule.exports = Row;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Row.jsx\n **/","const Fluxxor = require('fluxxor');\n\nconst actions = require('./actions/actions');\n\nconst PlaylistStore = require('./stores/Playlist');\n\nconst stores = {\n  playlist: new PlaylistStore()\n};\n\nconst flux = new Fluxxor.Flux(stores, actions);\n\nmodule.exports = flux;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/flux.js\n **/","const React = require('react');\n\nconst Column = React.createClass({\n\n  propTypes: {\n    s: React.PropTypes.number.isRequired,\n    m: React.PropTypes.number,\n    l: React.PropTypes.number\n  },\n\n  generateClassName: function () {\n    let className = `col-xs-${this.props.s}`;\n    if (this.props.m) {\n      className = `${className} col-md-${this.props.m}`;\n    }\n    if (this.props.l) {\n      className = `${className} col-lg-${this.props.l}`;\n    }\n    return className;\n  },\n\n  render: function () {\n    return (\n      <div className={this.generateClassName()}>\n        {this.props.children}\n      </div>\n    );\n  }\n});\n\nmodule.exports = Column;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Column.jsx\n **/","const React = require('react');\n\nconst FluidContainer = React.createClass({\n  render: function () {\n    return (\n      <div className=\"container-fluid\">\n        {\n          this.props.children\n        }\n      </div>\n    );\n  }\n});\n\nmodule.exports = FluidContainer;\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/FluidContainer.jsx\n **/","const React = require('react');\n\nconst Gliff = React.createClass({\n\n  propTypes: {\n    gliff: React.PropTypes.string.isRequired\n  },\n\n  render: function () {\n    return (\n      <span className={`glyphicon glyphicon-${this.props.gliff}`} aria-hidden=\"true\"></span>\n    );\n  }\n});\n\nmodule.exports = Gliff;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Gliff.jsx\n **/","const React = require('react');\n\nconst Row = require('./Row.jsx'),\n  Col = require('./Column.jsx');\n\nconst Track = React.createClass({\n\n  propertTypes: {\n    Track: React.PropTypes.object.isRequired\n  },\n\n  render: function () {\n    return (\n      <div className=\"track\">\n\n        <Row>\n          <Col s={6}>\n            {this.props.track.name}\n          </Col>\n          <Col s={6}>\n            {this.props.track.bpm}\n          </Col>\n        </Row>\n\n        <Row>\n          <Col s={12}>\n            {this.renderTrackAnalysis()}\n          </Col>\n        </Row>\n\n      </div>\n    );\n  },\n\n  renderTrackAnalysis: function () {\n    if (this.props.track.analysed) {\n      return this.renderAnalysis();\n    }\n\n    return this.renderAwaitingAnalysis();\n  },\n\n  renderAnalysis: function () {\n    return (\n      <svg className=\"track-analysis\">\n        {\n          this.props.track.peaks\n            .reduce(this.grabEveryFourthPeak, [])\n            .map(this.createSomeRectangles)\n        }\n      </svg>\n    );\n  },\n\n\n  renderAwaitingAnalysis: function () {\n    return (\n      <div className=\"awaiting-analysis\">\n        <span>Awaiting Analysis</span>\n      </div>\n    );\n  },\n\n  grabEveryFourthPeak: (acc, val, index) => {\n    if (index % 4 === 0) {\n      acc.push(val);\n    }\n    return acc;\n  },\n\n  createSomeRectangles: function (peak) {\n    const bufferLength = this.props.track.bufferLength;\n\n    let x = (100 * peak / bufferLength) + '%';\n\n    return (\n      <rect key={x} x={x} y=\"0\" width=\"1\" height=\"100%\"></rect>\n    );\n  }\n});\n\nmodule.exports = Track;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Track.jsx\n **/","const Fluxxor = require('fluxxor');\nconst LinkedStateMixin = require('react-addons-linked-state-mixin');\n\nmodule.exports = {\n  storeWatch: Fluxxor.StoreWatchMixin,\n  LinkedStateMixin: LinkedStateMixin\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/mixins.js\n **/","module.exports = {\n  PLAY_LIST: 'playlist'\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/constants/storeNames.js\n **/","module.exports = {\n  uploadTrack: require('./uploadTrack'),\n  nextTrack: require('./nextTrack'),\n  play: require('./playMusic'),\n  pause: require('./pauseMusic'),\n  trackPlaying: require('./trackPlaying')\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/actions/actions.js\n **/","const actionNames = require('../constants/actionNames');\n\nconst uploadTrack = function () {\n  this.dispatch(actionNames.NEXT_TRACK);\n};\n\nmodule.exports = uploadTrack;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/actions/nextTrack.js\n **/","const actionNames = require('../constants/actionNames');\n\nconst uploadTrack = function () {\n  this.dispatch(actionNames.PAUSE);\n};\n\nmodule.exports = uploadTrack;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/actions/pauseMusic.js\n **/","const actionNames = require('../constants/actionNames');\n\nconst uploadTrack = function () {\n  this.dispatch(actionNames.PLAY);\n};\n\nmodule.exports = uploadTrack;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/actions/playMusic.js\n **/","const actionNames = require('../constants/actionNames');\n\nconst uploadTrack = function (source, gain, trackLoaded) {\n  this.dispatch(actionNames.TRACK_PLAYING, {source: source, gain: gain, trackLoaded: trackLoaded});\n};\n\nmodule.exports = uploadTrack;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/actions/trackPlaying.js\n **/","const actionNames = require('../constants/actionNames');\n\nconst uploadTrack = function (track) {\n  this.dispatch(actionNames.UPLOAD_TRACK, track);\n};\n\nmodule.exports = uploadTrack;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/actions/uploadTrack.js\n **/","const React = require('react');\n\nconst Gliff = require('./Gliff.jsx');\n\nconst SaveButton = React.createClass({\n\n  propTypes: {\n    click: React.PropTypes.func.isRequired,\n    gliff: React.PropTypes.string.isRequired\n  },\n\n  render: function () {\n    return (\n      <button type=\"button\" onClick={this.props.click} className=\"btn btn-primary btn-block\">\n        <Gliff gliff={this.props.gliff}/>\n      </button>\n    );\n  }\n});\n\nmodule.exports = SaveButton;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Button.jsx\n **/","const React = require('react'),\n  NavBarContainer = require('./nav-bar-container.jsx');\n\nconst Layout = React.createClass({\n\n  render: function () {\n    return (\n      <div>\n        <NavBarContainer/>\n        { this.props.children }\n      </div>\n    );\n  }\n});\n\nmodule.exports = Layout;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Layout.jsx\n **/","const React = require('react');\n\nconst Col = require('./Column.jsx'),\n  Row = require('./Row.jsx'),\n  FluidContainer = require('./FluidContainer.jsx'),\n  Track = require('./Track.jsx'),\n  Button = require('./Button.jsx');\n\nconst flux = require('../flux'),\n  mixins = require('./mixins'),\n  storeNames = require('../constants/storeNames');\n\nconst fadeTimeSeconds = 3; // seconds\nconst startTrackAt = 70; // seconds\n\nconst context = new AudioContext();\n\nconst Player = React.createClass({\n\n  mixins: [mixins.storeWatch(storeNames.PLAY_LIST)],\n\n  getDefaultProps: function () {\n    return {\n      flux: flux\n    };\n  },\n\n  getStateFromFlux: function () {\n    return flux.store(storeNames.PLAY_LIST).getState();\n  },\n\n  play: function () {\n    let audioLoaded = this.state.trackLoaded;\n\n    if (audioLoaded) {\n      this.resume();\n    } else {\n      this.enqueueTrack();\n    }\n  },\n\n  enqueueTrack: function () {\n    let tracks = flux.store(storeNames.PLAY_LIST).getState().tracks,\n      currentTrack = tracks[0],\n      that = this;\n\n    Promise.resolve()\n    .then(() => {\n      console.log('starting playing');\n      return flux.actions.play();\n    })\n\n    .then(() => {\n      return that.prepTrack(currentTrack);\n    })\n\n    .then(({source, gain}) => {\n      return that.fadeIn(source, gain);\n    })\n\n    .then(({source, gain}) => {\n      return that.savePlayingTrack(source, gain);\n    });\n  },\n\n  pause: function () {\n    context.suspend();\n    flux.actions.pause();\n  },\n\n  resume: function () {\n    context.resume();\n    flux.actions.play();\n  },\n\n  savePlayingTrack: function (source, gain) {\n    return new Promise((resolve) => {\n      console.debug('save playing track');\n      flux.actions.trackPlaying(source, gain, true);\n      console.debug('now playing');\n      resolve();\n    });\n  },\n\n  prepTrack: function (track) {\n    console.debug('preparing track', track);\n    return new Promise((resolve) => {\n      context.decodeAudioData(track.arrayBuffer, function (buffer) {\n        let source = context.createBufferSource();\n        let gainNode = context.createGain();\n        source.buffer = buffer;\n        source.connect(gainNode);\n        gainNode.connect(context.destination);\n        console.log('track prepared', track);\n        resolve({source: source, gain: gainNode});\n      });\n    });\n  },\n\n  fadeIn: function (source, gainNode) {\n    return new Promise((resolve) => {\n      console.debug('fading in');\n      const currentTime = context.currentTime;\n\n      gainNode.gain.exponentialRampToValueAtTime(0.1, currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(1.0, currentTime + fadeTimeSeconds);\n\n      source.start(0, startTrackAt);\n\n      setTimeout(() => {\n        console.debug('faded track in');\n        resolve({source: source, gain: gainNode});\n      },\n      fadeTimeSeconds * 1000\n      );\n    });\n  },\n\n  fadeOut: function (source, gainNode) {\n\n    const currentTime = context.currentTime;\n\n    console.debug('fading out');\n\n    return new Promise((resolve) => {\n      gainNode.gain.exponentialRampToValueAtTime(1.0, currentTime);\n      gainNode.gain.exponentialRampToValueAtTime(0.1, currentTime + fadeTimeSeconds);\n\n      setTimeout(() => {\n        console.debug('faded out');\n        source.stop();\n        resolve();\n      },\n        fadeTimeSeconds * 1000\n      );\n    });\n  },\n\n  skip: function () {\n    const that = this,\n      state = flux.store(storeNames.PLAY_LIST).getState(),\n      tracks = state.tracks,\n      nextTrack = tracks[1];\n\n    let nextSource,\n      nextGain;\n\n    Promise.resolve()\n    .then(() => {\n      return that.prepTrack(nextTrack);\n    })\n    .then(({source, gain}) => {\n      nextSource = source;\n      nextGain = gain;\n      return that.fadeIn(source, gain);\n    })\n    .then(() => {\n      return that.fadeOut(state.source, state.gain);\n    })\n    .then(() => {\n      return that.savePlayingTrack(nextSource, nextGain);\n    })\n\n    .then(() => {\n      console.log('next Track');\n      flux.actions.nextTrack();\n    });\n\n    //  move playlist on\n  },\n\n  render: function () {\n\n    let tracks = flux.store(storeNames.PLAY_LIST).getState().tracks,\n      currentTrack = tracks[0],\n      nextTrack = tracks[1];\n\n    return (\n      <FluidContainer>\n        <Row>\n          {this.renderTrack(currentTrack)}\n        </Row>\n        <Row>\n          {this.renderTrack(nextTrack)}\n        </Row>\n        <hr/>\n        <Row>\n          <Col s={6}>\n            {this.renderPlayOrPause()}\n          </Col>\n          <Col s={6}>\n            <Button gliff=\"forward\" click={this.skip}/>\n          </Col>\n        </Row>\n      </FluidContainer>\n    );\n  },\n\n  renderTrack: (currentTrack) => {\n    if (currentTrack) {\n      return (\n       <Track track={currentTrack}/>\n      );\n    }\n    return (\n      <div><p>Queue Some Tracks!</p></div>\n    );\n  },\n\n  renderPlayOrPause: function () {\n    if (this.state.playing) {\n      return (\n        <Button gliff=\"pause\" click={this.pause}/>\n      );\n    }\n    return (\n      <Button gliff=\"play\" click={this.play}/>\n    );\n  }\n});\n\nmodule.exports = Player;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Player.jsx\n **/","const React = require('react');\n\nconst flux = require('../flux');\n\nconst Dropzone = require('react-dropzone'),\n  FluidContainer = require('./FluidContainer.jsx'),\n  Row = require('./Row.jsx'),\n  Tracks = require('./Tracks.jsx');\n\nconst Playlist = React.createClass({\n\n  onDrop: function (files) {\n    console.log(files);\n    flux.actions.uploadTrack(files[0]);\n  },\n\n  render: function () {\n    return (\n      <div className=\"playlist\">\n        <FluidContainer>\n          <Row>\n            <Dropzone className=\"upload\" onDrop={this.onDrop} multiple={false}>\n              <span className=\"upload-txt\">Drop Tracks here, or click to select tracks from your file system</span>\n            </Dropzone>\n          </Row>\n          <Row>\n            <Tracks/>\n          </Row>\n        </FluidContainer>\n      </div>\n    );\n  }\n});\n\nmodule.exports = Playlist;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Playlist.jsx\n **/","const React = require('react');\n\nconst flux = require('../flux'),\n  mixins = require('./mixins'),\n  storeNames = require('../constants/storeNames');\n\nconst Row = require('./Row.jsx'),\n  Col = require('./Column.jsx'),\n  Track = require('./Track.jsx');\n\nconst Tracks = React.createClass({\n\n  mixins: [mixins.storeWatch(storeNames.PLAY_LIST)],\n\n  getDefaultProps: function () {\n    return {\n      flux: flux\n    };\n  },\n\n  getStateFromFlux: function () {\n    return flux.store(storeNames.PLAY_LIST).getState();\n  },\n\n  render: function () {\n    return (\n      <div className=\"tracks\">\n        <Row>\n          <Col s={12}>\n            <ol>\n            {\n              this.state.tracks.map(this.renderTrack)\n            }\n            </ol>\n          </Col>\n        </Row>\n      </div>\n    );\n  },\n\n  renderTrack: (track) => (\n    <li key={track.id}>\n      <Track track={track}/>\n    </li>\n  )\n});\n\nmodule.exports = Tracks;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/Tracks.jsx\n **/","var React = require('react'),\n  Link = require('react-router').Link,\n  Gliff = require('./Gliff.jsx');\n\nvar NavBarContainer = React.createClass({\n\n  render: () => {\n    return (\n      <nav className=\"navbar navbar-default navbar-fixed-top\">\n        <div className=\"container-fluid\">\n\n                      <div className=\"navbar-header\">\n            <button type=\"button\" className=\"navbar-toggle collapsed\"\n                    data-toggle=\"collapse\" data-target=\"#navbar\" aria-expanded=\"false\" aria-controls=\"navbar\">\n              <span className=\"sr-only\">Toggle navigation</span>\n              <span className=\"icon-bar\"></span>\n              <span className=\"icon-bar\"></span>\n              <span className=\"icon-bar\"></span>\n            </button>\n            <Link to=\"/\">\n              <h3>\n                <Gliff gliff=\"cd\"/> Auto DJ\n              </h3>\n            </Link>\n          </div>\n\n          <div id=\"navbar\" className=\"navbar-collapse collapse\">\n            <ul className=\"nav navbar-nav\">\n              <li>\n                <Link to=\"/playlist\">\n                  <Gliff gliff=\"list\"/>\n                  {\n                    `  Play List`\n                  }\n                </Link>\n              </li>\n              <li>\n                <Link to=\"/player\">\n                  <Gliff gliff=\"equalizer\"/>\n                  {\n                    `  Playing`\n                  }\n                </Link>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </nav>\n    );\n  }\n});\n\nmodule.exports = NavBarContainer;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/components/nav-bar-container.jsx\n **/","const history = require('history').createHistory();\n\nmodule.exports = history;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/history.js\n **/","// FLUX CONFIG\n\nrequire('./flux');\n\n// ROUTE CONFIG\n\nconst React = require('react'), // eslint-disable-line no-unused-vars\n  reactRouter = require('react-router'),\n  Router = reactRouter.Router,\n  Route = reactRouter.Route,\n  IndexRoute = reactRouter.IndexRoute,\n  ReactDom = require('react-dom');\n\nconst Layout = require('./components/Layout.jsx'),\n  Player = require('./components/Player.jsx'),\n  Playlist = require('./components/Playlist.jsx');\n\nconst history = require('./history');\n\nReactDom.render(\n  <Router history={history}>\n    <Route path=\"./\" component={Layout}>\n      <Route path=\"player\" component={Player}/>\n      <IndexRoute component={Playlist}/>\n\n      <Route path=\"playlist\" components={Playlist}/>\n    </Route>\n  </Router>,\n  document.getElementById('app'));\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/main.jsx\n **/","const Fluxxor = require('fluxxor'),\n  uuid = require('uuid'),\n  R = require('ramda');\n\nconst actionNames = require('../constants/actionNames'),\n  beatDetector = require('./beatDetector');\n\nconst PlaylistStore = Fluxxor.createStore({\n\n  initialize: function () {\n    this.state = {\n      tracks: [],\n      playing: false,\n      trackLoaded: false\n    };\n\n    this.bindActions(\n      actionNames.UPLOAD_TRACK, this.dealWithUploadedTrack,\n      actionNames.NEXT_TRACK, this.nextTrack,\n      actionNames.PLAY, this.play,\n      actionNames.PAUSE, this.pause,\n      actionNames.TRACK_PLAYING, this.trackPlaying\n    );\n  },\n\n  getState: function () {\n    return this.state;\n  },\n\n  nextTrack: function () {\n    this.state.tracks = R.drop(1, this.state.tracks);\n    this.emit('change');\n  },\n\n  play: function () {\n    this.state.playing = true;\n    this.state.trackLoaded = true;\n    this.emit('change');\n  },\n\n  pause: function () {\n    this.state.playing = false;\n    this.emit('change');\n  },\n\n  trackPlaying: function ({source, gain, trackLoaded}) {\n    this.state.source = source;\n    this.state.gain = gain;\n    this.state.trackLoaded = trackLoaded;\n    this.emit('change');\n  },\n\n  dealWithUploadedTrack: function (uploadedTrack) {\n\n    let track = {\n      id: uuid.v1(),\n      name: uploadedTrack.name,\n      type: uploadedTrack.type,\n      analysed: false,\n      track: uploadedTrack\n    };\n\n    let that = this;\n\n    let reader = new FileReader();\n\n    Promise\n      .resolve()\n\n      .then(() => {\n        return new Promise((resolve) => {\n          console.log('adding track');\n          this.state.tracks.push(track);\n          this.emit('change');\n          resolve();\n        });\n      })\n\n      .then(() => {\n        return new Promise((resolve, reject) => {\n          console.log('reading uploaded file');\n          reader.onload = function(event) {\n            console.log('loaded file');\n            resolve(event);\n          };\n\n          reader.onerror = function(event) {\n            console.log('failed to load file');\n            reject(event);\n          };\n\n          reader.readAsArrayBuffer(uploadedTrack);\n        });\n      })\n\n      .then((fileReadEvent) => {\n        return new Promise((resolve) => {\n          console.log('crunching bpm', fileReadEvent);\n          var OfflineContext = window.OfflineAudioContext || window.webkitOfflineAudioContext;\n          var offlineContext = new OfflineContext(1, 2, 44100);\n\n          track.arrayBuffer = fileReadEvent.target.result;\n\n          offlineContext.decodeAudioData(fileReadEvent.target.result, function (buffer) {\n\n            // Create buffer source\n            var source = offlineContext.createBufferSource();\n            source.buffer = buffer;\n\n            // Create filter\n            var filter = offlineContext.createBiquadFilter();\n            filter.type = 'lowpass';\n\n            // Pipe the song into the filter, and the filter into the offline context\n            source.connect(filter);\n            filter.connect(offlineContext.destination);\n\n            // Schedule the song to start playing at time:0\n            source.start(0);\n\n            var peaks,\n              initialThresold = 0.9,\n              thresold = initialThresold,\n              minThresold = 0.3,\n              minPeaks = 30;\n\n            do {\n              peaks = beatDetector.getPeaksAtThreshold(buffer.getChannelData(0), thresold);\n              thresold -= 0.05;\n            } while (peaks.length < minPeaks && thresold >= minThresold);\n\n\n            var intervals = beatDetector.countIntervalsBetweenNearbyPeaks(peaks);\n\n            var groups = beatDetector.groupNeighborsByTempo(intervals, buffer.sampleRate);\n\n            var top = groups.sort(function (intA, intB) {\n              return intB.count - intA.count;\n            }).splice(0, 5);\n\n            track.peaks = peaks;\n            track.analysed = true;\n            track.bpm = top[0].tempo;\n            track.bufferLength = buffer.length;\n            resolve();\n          });\n        });\n      })\n\n      .catch((error) => {\n        return console.error('failed to bpm match the file', error);\n      })\n\n      .then(() => {\n        console.log('done analysis');\n        that.emit('change');\n      });\n  }\n});\n\nmodule.exports = PlaylistStore;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/stores/Playlist.js\n **/","// lifted from https://github.com/JMPerez/beats-audio-api/blob/gh-pages/script.js - thank you JMPerez :)\n\nconst getPeaksAtThreshold = (data, threshold) => {\n  var peaksArray = [];\n  var length = data.length;\n  for (var i = 0; i < length;) {\n    if (data[i] > threshold) {\n      peaksArray.push(i);\n      // Skip forward ~ 1/4s to get past this peak.\n      i += 10000;\n    }\n    i++;\n  }\n  return peaksArray;\n};\n\n// Function used to return a histogram of peak intervals\nconst countIntervalsBetweenNearbyPeaks = (peaks) => {\n  var intervalCounts = [];\n  peaks.forEach(function(peak, index) {\n    for (var i = 0; i < 10; i++) {\n      var interval = peaks[index + i] - peak;\n      var foundInterval = intervalCounts.some(function(intervalCount) { // eslint-disable-line no-loop-func\n        if (intervalCount.interval === interval) {\n          return intervalCount.count++;\n        }\n      });\n      if (!foundInterval) {\n        intervalCounts.push({\n          interval: interval,\n          count: 1\n        });\n      }\n    }\n  });\n  return intervalCounts;\n};\n\n// Function used to return a histogram of tempo candidates.\nconst groupNeighborsByTempo = (intervalCounts, sampleRate) => {\n  var tempoCounts = [];\n  intervalCounts.forEach(function(intervalCount) {\n    if (intervalCount.interval !== 0) {\n      // Convert an interval to tempo\n      var theoreticalTempo = 60 / (intervalCount.interval / sampleRate);\n\n      // Adjust the tempo to fit within the 90-180 BPM range\n      while (theoreticalTempo < 90) {\n        theoreticalTempo *= 2;\n      }\n      while (theoreticalTempo > 180) {\n        theoreticalTempo /= 2;\n      }\n\n      theoreticalTempo = Math.round(theoreticalTempo);\n      var foundTempo = tempoCounts.some(function(tempoCount) {\n        if (tempoCount.tempo === theoreticalTempo) {\n          tempoCount.count += intervalCount.count;\n          return tempoCount.count;\n        }\n      });\n      if (!foundTempo) {\n        tempoCounts.push({\n          tempo: theoreticalTempo,\n          count: intervalCount.count\n        });\n      }\n    }\n  });\n  return tempoCounts;\n};\n\nmodule.exports = {\n  getPeaksAtThreshold: getPeaksAtThreshold,\n  countIntervalsBetweenNearbyPeaks: countIntervalsBetweenNearbyPeaks,\n  groupNeighborsByTempo: groupNeighborsByTempo\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/stores/beatDetector.js\n **/"],"sourceRoot":""}